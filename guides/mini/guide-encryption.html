<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2015-04-05 
 | Rendered using Apache Maven Fluido Skin 1.3.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Oleg Gusakov
Robert Scholte" />
    <meta name="Date-Creation-yyyymmdd" content="20140323" />
    <meta name="Date-Revision-yyyymmdd" content="20150405" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Maven &#x2013; Password Encryption</title>
    <link rel="stylesheet" href="../../css/apache-maven-fluido-1.3.1.min.css" />
    <link rel="stylesheet" href="../../css/site.css" />
    <link rel="stylesheet" href="../../css/print.css" media="print" />

      
    <script type="text/javascript" src="../../js/apache-maven-fluido-1.3.1.min.js"></script>

                          
        
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script>
                      
        
<script type="text/javascript">_uacct = "UA-140879-1";
        urchinTracker();</script>
          
                  </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="http://www.apache.org/" id="bannerLeft">
                                                                                                <img src="../../images/apache-maven-project.png" />
                </a>
                      </div>
        <div class="pull-right">                                <a href="../.././" id="bannerRight">
                                                                                                <img src="../../images/maventxt_logo_200.gif" />
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                              <li class="">
                    <a href="http://www.apache.org/" class="externalLink" title="Apache">
        Apache</a>
                    <span class="divider">/</span>
      </li>
            <li class="">
                    <a href="../../index.html" title="Maven">
        Maven</a>
                    <span class="divider">/</span>
      </li>
        <li class="active ">Password Encryption</li>
        
                
                    
                  <li id="publishDate" class="pull-right">Last Published: 2015-04-05</li>
            
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Main</li>
                              
      <li>
  
                          <a href="../../index.html" title="Welcome">
          <i class="none"></i>
        Welcome</a>
            </li>
                              <li class="nav-header">Get Maven</li>
                              
      <li>
  
                          <a href="../../download.html" title="Download">
          <i class="none"></i>
        Download</a>
            </li>
                
      <li>
  
                          <a href="../../docs/history.html" title="Releases History">
          <i class="none"></i>
        Releases History</a>
            </li>
                
      <li>
  
                          <a href="../../docs/3.3.1/release-notes.html" title="Release Notes (3.3.1)">
          <i class="none"></i>
        Release Notes (3.3.1)</a>
            </li>
                
      <li>
  
                          <a href="../../docs/3.2.5/release-notes.html" title="Release Notes (3.2.5)">
          <i class="none"></i>
        Release Notes (3.2.5)</a>
            </li>
                
      <li>
  
                          <a href="../../docs/3.1.1/release-notes.html" title="Release Notes (3.1.1)">
          <i class="none"></i>
        Release Notes (3.1.1)</a>
            </li>
                
      <li>
  
                          <a href="../../docs/3.0.5/release-notes.html" title="Release Notes (3.0.5)">
          <i class="none"></i>
        Release Notes (3.0.5)</a>
            </li>
                
      <li>
  
                          <a href="../../release-notes-all.html" title="All Release Notes">
          <i class="none"></i>
        All Release Notes</a>
            </li>
                
      <li>
  
                          <a href="http://www.apache.org/licenses/" class="externalLink" title="License">
          <i class="none"></i>
        License</a>
            </li>
                
      <li>
  
                          <a href="../../security.html" title="Security">
          <i class="none"></i>
        Security</a>
            </li>
                              <li class="nav-header">IDE Integration</li>
                              
      <li>
  
                          <a href="../../eclipse-plugin.html" title="Eclipse">
          <i class="none"></i>
        Eclipse</a>
            </li>
                
      <li>
  
                          <a href="../../netbeans-module.html" title="NetBeans">
          <i class="none"></i>
        NetBeans</a>
            </li>
                              <li class="nav-header">About Maven</li>
                              
      <li>
  
                          <a href="../../what-is-maven.html" title="What is Maven?">
          <i class="none"></i>
        What is Maven?</a>
            </li>
                
      <li>
  
                          <a href="../../maven-features.html" title="Features">
          <i class="none"></i>
        Features</a>
            </li>
                
      <li>
  
                          <a href="../../general.html" title="FAQ (official)">
          <i class="none"></i>
        FAQ (official)</a>
            </li>
                
      <li>
  
                          <a href="http://docs.codehaus.org/display/MAVENUSER/FAQs-1" class="externalLink" title="FAQ (unofficial)">
          <i class="none"></i>
        FAQ (unofficial)</a>
            </li>
                
      <li>
  
                          <a href="../../support-and-training.html" title="Support and Training">
          <i class="none"></i>
        Support and Training</a>
            </li>
                              <li class="nav-header">Documentation</li>
                              
      <li>
  
                          <a href="../../plugins/index.html" title="Maven Plugins">
          <i class="none"></i>
        Maven Plugins</a>
            </li>
                
      <li>
  
                          <a href="../../guides/index.html" title="Index (category)">
          <i class="none"></i>
        Index (category)</a>
            </li>
                
      <li>
  
                          <a href="../../run-maven/index.html" title="Running Maven">
          <i class="none"></i>
        Running Maven</a>
            </li>
                                                                                                                                          
      <li>
  
                          <a href="../../users/index.html" title="User Centre">
          <i class="icon-chevron-right"></i>
        User Centre</a>
                  </li>
                                                                                                      
      <li>
  
                          <a href="../../plugin-developers/index.html" title="Plugin Developer Centre">
          <i class="icon-chevron-right"></i>
        Plugin Developer Centre</a>
                  </li>
                
      <li>
  
                          <a href="../../repository/index.html" title="Maven Repository Centre">
          <i class="none"></i>
        Maven Repository Centre</a>
            </li>
                
      <li>
  
                          <a href="../../developers/index.html" title="Maven Developer Centre">
          <i class="none"></i>
        Maven Developer Centre</a>
            </li>
                
      <li>
  
                          <a href="../../articles.html" title="Books and Resources">
          <i class="none"></i>
        Books and Resources</a>
            </li>
                
      <li>
  
                          <a href="http://docs.codehaus.org/display/MAVENUSER/Home" class="externalLink" title="Wiki">
          <i class="none"></i>
        Wiki</a>
            </li>
                              <li class="nav-header">Community</li>
                              
      <li>
  
                          <a href="../../community.html" title="Community Overview">
          <i class="none"></i>
        Community Overview</a>
            </li>
                
      <li>
  
                          <a href="../../guides/development/guide-helping.html" title="How to Contribute">
          <i class="none"></i>
        How to Contribute</a>
            </li>
                
      <li>
  
                          <a href="../../guides/mini/guide-maven-evangelism.html" title="Maven Repository">
          <i class="none"></i>
        Maven Repository</a>
            </li>
                
      <li>
  
                          <a href="../../users/getting-help.html" title="Getting Help">
          <i class="none"></i>
        Getting Help</a>
            </li>
                
      <li>
  
                          <a href="../../issue-tracking.html" title="Issue Tracking">
          <i class="none"></i>
        Issue Tracking</a>
            </li>
                
      <li>
  
                          <a href="../../source-repository.html" title="Source Repository">
          <i class="none"></i>
        Source Repository</a>
            </li>
                
      <li>
  
                          <a href="../../team-list.html" title="The Maven Team">
          <i class="none"></i>
        The Maven Team</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                          
      <li>
  
                          <a href="../../project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
                              <li class="nav-header">Maven Projects</li>
                              
      <li>
  
                          <a href="../../ant-tasks/index.html" title="Ant Tasks">
          <i class="none"></i>
        Ant Tasks</a>
            </li>
                
      <li>
  
                          <a href="../../archetype/index.html" title="Archetype">
          <i class="none"></i>
        Archetype</a>
            </li>
                
      <li>
  
                          <a href="../../doxia/index.html" title="Doxia">
          <i class="none"></i>
        Doxia</a>
            </li>
                
      <li>
  
                          <a href="../../jxr/index.html" title="JXR">
          <i class="none"></i>
        JXR</a>
            </li>
                
      <li>
  
                          <a href="../../ref/current" title="Maven">
          <i class="none"></i>
        Maven</a>
            </li>
                
      <li>
  
                          <a href="../../pom/index.html" title="Parent POMs">
          <i class="none"></i>
        Parent POMs</a>
            </li>
                
      <li>
  
                          <a href="../../plugins/index.html" title="Plugins">
          <i class="none"></i>
        Plugins</a>
            </li>
                
      <li>
  
                          <a href="../../plugin-testing/index.html" title="Plugin Testing">
          <i class="none"></i>
        Plugin Testing</a>
            </li>
                
      <li>
  
                          <a href="../../plugin-tools/index.html" title="Plugin Tools">
          <i class="none"></i>
        Plugin Tools</a>
            </li>
                
      <li>
  
                          <a href="../../apache-resource-bundles/index.html" title="Resource Bundles">
          <i class="none"></i>
        Resource Bundles</a>
            </li>
                
      <li>
  
                          <a href="../../scm/index.html" title="SCM">
          <i class="none"></i>
        SCM</a>
            </li>
                
      <li>
  
                          <a href="../../shared/index.html" title="Shared Components">
          <i class="none"></i>
        Shared Components</a>
            </li>
                
      <li>
  
                          <a href="../../skins/index.html" title="Skins">
          <i class="none"></i>
        Skins</a>
            </li>
                
      <li>
  
                          <a href="../../surefire/index.html" title="Surefire">
          <i class="none"></i>
        Surefire</a>
            </li>
                
      <li>
  
                          <a href="../../wagon/index.html" title="Wagon">
          <i class="none"></i>
        Wagon</a>
            </li>
                              <li class="nav-header">ASF</li>
                              
      <li>
  
                          <a href="http://www.apache.org/foundation/how-it-works.html" class="externalLink" title="How Apache Works">
          <i class="none"></i>
        How Apache Works</a>
            </li>
                
      <li>
  
                          <a href="http://www.apache.org/foundation/" class="externalLink" title="Foundation">
          <i class="none"></i>
        Foundation</a>
            </li>
                
      <li>
  
                          <a href="http://www.apache.org/foundation/sponsorship.html" class="externalLink" title="Sponsoring Apache">
          <i class="none"></i>
        Sponsoring Apache</a>
            </li>
                
      <li>
  
                          <a href="http://www.apache.org/foundation/thanks.html" class="externalLink" title="Thanks">
          <i class="none"></i>
        Thanks</a>
            </li>
            </ul>
                
                    
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <!-- Licensed to the Apache Software Foundation (ASF) under one --><!-- or more contributor license agreements.  See the NOTICE file --><!-- distributed with this work for additional information --><!-- regarding copyright ownership.  The ASF licenses this file --><!-- to you under the Apache License, Version 2.0 (the --><!-- "License"); you may not use this file except in compliance --><!-- with the License.  You may obtain a copy of the License at --><!--  --><!-- http://www.apache.org/licenses/LICENSE-2.0 --><!--  --><!-- Unless required by applicable law or agreed to in writing, --><!-- software distributed under the License is distributed on an --><!-- "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY --><!-- KIND, either express or implied.  See the License for the --><!-- specific language governing permissions and limitations --><!-- under the License. --><!-- NOTE: For help with the syntax of this file, see: --><!-- http://maven.apache.org/doxia/references/apt-format.html --><div class="section">
<h2><a name="Password_Encryption">Password Encryption</a></h2>
<ol style="list-style-type: decimal">
<li><a href="#Introduction">Introduction</a></li>
<li><a href="#How_to_create_a_master_password">How to create a master password</a></li>
<li><a href="#How_to_encrypt_server_passwords">How to encrypt server passwords</a></li>
<li><a href="#How_to_keep_the_master_password_on_removable_drive">How to keep the master password on removable drive</a></li>
<li><a href="#Tips">Tips</a></li></ol>
<div class="section">
<h3><a name="Introduction">Introduction</a></h3>
<p>Maven 2.1.0+ now supports server password encryption. The main use case, addressed by this solution is:</p>
<ul>
<li>multiple users share the same build machine (server, CI box)</li>
<li>some users have the privilege to deploy Maven artifacts to repositories, some don't.
<ul>
<li>this applies to any server operations, requiring authorization, not only deployment</li></ul></li>
<li><tt>settings.xml</tt> is shared between users</li></ul>
<p>The implemented solution adds the following capabilities:</p>
<ul>
<li>authorized users have an additional <tt>settings-security.xml</tt> file in their <tt>~/.m2</tt> folder
<ul>
<li>this file either contains encrypted <b>master password</b>, used to encrypt other passwords</li>
<li>or it can contain a <b>relocation</b> - reference to another file, possibly on removable storage</li>
<li>this password is created first via CLI for now</li></ul></li>
<li>server entries in the <tt>settings.xml</tt> have passwords and/or keystore passphrases encrypted
<ul>
<li>for now - this is done via CLI <b>after</b> master password has been created and stored in appropriate location</li></ul></li></ul></div>
<div class="section">
<h3><a name="How_to_create_a_master_password">How to create a master password</a></h3>
<p>Use the following command line:</p>
<div class="source">
<pre>mvn --encrypt-master-password &lt;password&gt;</pre></div>
<p><i>Note:</i> Since Maven 3.2.1 the password is an optional argument. If not provided, Maven will prompt for the password. Earlier versions of Maven will not prompt for a password, so it must be typed on the command-line in plaintext. See <a href="#Tips">Tips</a> below for more information.</p>
<p>This command will produce an encrypted version of the password, something like</p>
<div class="source">
<pre>{jSMOWnoPFgsHVpMvz5VrIt5kRbzGpI8u+9EF1iFQyJQ=}</pre></div>
<p>Store this password in the <tt>~/.m2/settings-security.xml</tt>; it should look like</p>
<div class="source">
<pre>&lt;settingsSecurity&gt;
  &lt;master&gt;{jSMOWnoPFgsHVpMvz5VrIt5kRbzGpI8u+9EF1iFQyJQ=}&lt;/master&gt;
&lt;/settingsSecurity&gt;</pre></div>
<p>When this is done, you can start encrypting existing server passwords.</p></div>
<div class="section">
<h3><a name="How_to_encrypt_server_passwords">How to encrypt server passwords</a></h3>
<p>You will have to use the following command line:</p>
<div class="source">
<pre>mvn --encrypt-password &lt;password&gt;</pre></div>
<p><i>Note:</i>Just like <tt>--encrypt-master-password</tt> the password argument is optional since Maven 3.2.1.</p>
<p>This command will produce an encrypted version of it, something like</p>
<div class="source">
<pre>{COQLCE6DU6GtcS5P=}</pre></div>
<p>Cut-n-paste it into your <tt>settings.xml</tt> file in the server section. This will look like:</p>
<div class="source">
<pre>&lt;settings&gt;
...
  &lt;servers&gt;
...
    &lt;server&gt;
      &lt;id&gt;my.server&lt;/id&gt;
      &lt;username&gt;foo&lt;/username&gt;
      &lt;password&gt;{COQLCE6DU6GtcS5P=}&lt;/password&gt;
    &lt;/server&gt;
...
  &lt;/servers&gt;
...
&lt;/settings&gt;</pre></div>
<p>Please note that password can contain any information outside of the curly brackets, so that the following will still work:</p>
<div class="source">
<pre>&lt;settings&gt;
...
  &lt;servers&gt;
...
    &lt;server&gt;
      &lt;id&gt;my.server&lt;/id&gt;
      &lt;username&gt;foo&lt;/username&gt;
      &lt;password&gt;Oleg reset this password on 2009-03-11, expires on 2009-04-11 {COQLCE6DU6GtcS5P=}&lt;/password&gt;
    &lt;/server&gt;
...
  &lt;/servers&gt;
...
&lt;/settings&gt;</pre></div>
<p>Then you can use, say, deploy plugin, to write to this server:</p>
<div class="source">
<pre>mvn deploy:deploy-file -Durl=https://maven.corp.com/repo \
                       -DrepositoryId=my.server \
                       -Dfile=your-artifact-1.0.jar \</pre></div></div>
<div class="section">
<h3><a name="How_to_keep_the_master_password_on_removable_drive">How to keep the master password on removable drive</a></h3>
<p>Create the master password exactly as described above, and store it on a removable drive, for instance on OSX, my USB drive mounts as <tt>/Volumes/mySecureUsb</tt>, so I store</p>
<div class="source">
<pre>&lt;settingsSecurity&gt;
  &lt;master&gt;{jSMOWnoPFgsHVpMvz5VrIt5kRbzGpI8u+9EF1iFQyJQ=}&lt;/master&gt;
&lt;/settingsSecurity&gt;</pre></div>
<p>in the file <tt>/Volumes/mySecureUsb/secure/settings-security.xml</tt></p>
<p>And then I create <tt>~/.m2/settings-security.xml</tt> with the following content:</p>
<div class="source">
<pre>&lt;settingsSecurity&gt;
  &lt;relocation&gt;/Volumes/mySecureUsb/secure/settings-security.xml&lt;/relocation&gt;
&lt;/settingsSecurity&gt;</pre></div>
<p>This assures that encryption will only work when the usb drive is mounted by OS. This addresses a use case where only certain people are authorized to deploy and are issued these devices.</p></div>
<div class="section">
<h3><a name="Tips">Tips</a></h3>
<div class="section">
<h4><a name="Escaping_curly-brace_literals_in_your_password_Since:_Maven_2.2.0"></a>Escaping curly-brace literals in your password <i>(Since: Maven 2.2.0)</i></h4>
<p>At times, you might find that your password (or the encrypted form of it) may actually contain '{' or '}' as a literal value. If you added such a password as-is to your settings.xml file, you would find that Maven does strange things with it. Specifically, Maven will treat all the characters preceding the '{' literal, and all the characters after the '}' literal, as comments. Obviously, this is not the behavior you want in such a situation. What you really need is a way of <b>escaping</b> the curly-brace literals in your password.</p>
<p>Starting in Maven 2.2.0, you can do just this, with the widely used '\' escape character. If your password looks like this:</p>
<div class="source">
<pre>jSMOWnoPFgsHVpMvz5VrIt5kRbzGpI8u+{EF1iFQyJQ=</pre></div>
<p>Then, the value you would add to your settings.xml would look like this:</p>
<div class="source">
<pre>{jSMOWnoPFgsHVpMvz5VrIt5kRbzGpI8u+\{EF1iFQyJQ=}</pre></div></div>
<div class="section">
<h4><a name="Password_Security"></a>Password Security</h4>
<p>Editing <tt>settings.xml</tt> and running the above commands can still leave your password stored locally in plaintext. You may want to check the following locations:</p>
<ul>
<li>Shell history (e.g. by running <tt>history</tt>). You may want to clear your history after encrypting the above passwords</li>
<li>Editor caches (e.g. <tt>~/.viminfo</tt>)</li></ul>
<p>Also note that the encrypted passwords can be decrypted by someone that has the master password and settings security file. Keep this file secure (or stored separately) if you expect the possibility that the <tt>settings.xml</tt> file may be retrieved.</p></div>
<div class="section">
<h4><a name="Password_Escaping_on_different_platforms"></a>Password Escaping on different platforms</h4>
<p>On some platforms it might be neccessary to quote your password based on the content of your password in particular having special characters like <tt>%</tt>, <tt>!</tt>, <tt>$</tt> etc. in there. For example on Windows you have to be carefull about things like the following:</p>
<p>The following example will not work on Windows:</p>
<div class="source">
<pre>mvn.bat --encrypt-master-password a!$%^b</pre></div>
<p>whereas the following will work on Windows:</p>
<div class="source">
<pre>mvn.bat --encrypt-master-password &quot;a!$%^b&quot;</pre></div>
<p>If you are on a linux/unix platform you should use single quotes for the above master password otherwise you will be astonished that the usage of the master-password will not work (caused by the dollar sign and furthermore the exclamation mark).</p></div></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                              <p >Copyright &copy;                    2002&#x2013;2015
                        <a href="http://www.apache.org/">The Apache Software Foundation</a>.
            All rights reserved.      
                    
      </p>
        </div>

        
        
                </div>
    </footer>
        </body>
</html>
