<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2015-04-13 
 | Rendered using Apache Maven Fluido Skin 1.4-SNAPSHOT
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="John Casey
Dennis Lundberg" />
    <meta name="Date-Creation-yyyymmdd" content="20101217" />
    <meta name="Date-Revision-yyyymmdd" content="20150413" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Maven &#x2013; Guide to Developing Ant Plugins</title>
    <link rel="stylesheet" href="../../css/apache-maven-fluido-1.4-SNAPSHOT.min.css" />
    <link rel="stylesheet" href="../../css/site.css" />
    <link rel="stylesheet" href="../../css/print.css" media="print" />

      
    <script type="text/javascript" src="../../js/apache-maven-fluido-1.4-SNAPSHOT.min.js"></script>

                          
        
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script>
                      
        
<script type="text/javascript">_uacct = "UA-140879-1";
        urchinTracker();</script>
          
                  </head>
        <body class="topBarDisabled">
          
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="http://www.apache.org/" id="bannerLeft">
                                                                                                <img src="../../images/apache-maven-project.png" />
                </a>
                      </div>
        <div class="pull-right">                                <a href="../.././" id="bannerRight">
                                                                                                <img src="../../images/maven-logo-black-on-white.png" />
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                              <li class="">
                    <a href="http://www.apache.org/" class="externalLink" title="Apache">
        Apache</a>
                    <span class="divider">/</span>
      </li>
            <li class="">
                    <a href="../../index.html" title="Maven">
        Maven</a>
                    <span class="divider">/</span>
      </li>
        <li class="active ">Guide to Developing Ant Plugins</li>
        
                
                    
                  <li id="publishDate" class="pull-right">Last Published: 2015-04-13</li>
            
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Main</li>
                              
      <li>
  
                          <a href="../../index.html" title="Welcome">
          <span class="none"></span>
        Welcome</a>
            </li>
                              <li class="nav-header">Get Maven</li>
                              
      <li>
  
                          <a href="../../download.html" title="Download">
          <span class="none"></span>
        Download</a>
            </li>
                
      <li>
  
                          <a href="../../docs/history.html" title="Releases History">
          <span class="none"></span>
        Releases History</a>
            </li>
                
      <li>
  
                          <a href="../../docs/3.3.1/release-notes.html" title="Release Notes (3.3.1)">
          <span class="none"></span>
        Release Notes (3.3.1)</a>
            </li>
                
      <li>
  
                          <a href="../../docs/3.2.5/release-notes.html" title="Release Notes (3.2.5)">
          <span class="none"></span>
        Release Notes (3.2.5)</a>
            </li>
                
      <li>
  
                          <a href="../../docs/3.1.1/release-notes.html" title="Release Notes (3.1.1)">
          <span class="none"></span>
        Release Notes (3.1.1)</a>
            </li>
                
      <li>
  
                          <a href="../../docs/3.0.5/release-notes.html" title="Release Notes (3.0.5)">
          <span class="none"></span>
        Release Notes (3.0.5)</a>
            </li>
                
      <li>
  
                          <a href="../../release-notes-all.html" title="All Release Notes">
          <span class="none"></span>
        All Release Notes</a>
            </li>
                
      <li>
  
                          <a href="http://www.apache.org/licenses/" class="externalLink" title="License">
          <span class="none"></span>
        License</a>
            </li>
                
      <li>
  
                          <a href="../../security.html" title="Security">
          <span class="none"></span>
        Security</a>
            </li>
                              <li class="nav-header">IDE Integration</li>
                              
      <li>
  
                          <a href="../../eclipse-plugin.html" title="Eclipse">
          <span class="none"></span>
        Eclipse</a>
            </li>
                
      <li>
  
                          <a href="../../netbeans-module.html" title="NetBeans">
          <span class="none"></span>
        NetBeans</a>
            </li>
                              <li class="nav-header">About Maven</li>
                              
      <li>
  
                          <a href="../../what-is-maven.html" title="What is Maven?">
          <span class="none"></span>
        What is Maven?</a>
            </li>
                
      <li>
  
                          <a href="../../maven-features.html" title="Features">
          <span class="none"></span>
        Features</a>
            </li>
                
      <li>
  
                          <a href="../../general.html" title="FAQ (official)">
          <span class="none"></span>
        FAQ (official)</a>
            </li>
                
      <li>
  
                          <a href="http://docs.codehaus.org/display/MAVENUSER/FAQs-1" class="externalLink" title="FAQ (unofficial)">
          <span class="none"></span>
        FAQ (unofficial)</a>
            </li>
                
      <li>
  
                          <a href="../../support-and-training.html" title="Support and Training">
          <span class="none"></span>
        Support and Training</a>
            </li>
                              <li class="nav-header">Documentation</li>
                              
      <li>
  
                          <a href="../../plugins/index.html" title="Maven Plugins">
          <span class="none"></span>
        Maven Plugins</a>
            </li>
                
      <li>
  
                          <a href="../../guides/index.html" title="Index (category)">
          <span class="none"></span>
        Index (category)</a>
            </li>
                
      <li>
  
                          <a href="../../run-maven/index.html" title="Running Maven">
          <span class="none"></span>
        Running Maven</a>
            </li>
                                                                                                                                          
      <li>
  
                          <a href="../../users/index.html" title="User Centre">
          <span class="icon-chevron-right"></span>
        User Centre</a>
                  </li>
                                                                                                      
      <li>
  
                          <a href="../../plugin-developers/index.html" title="Plugin Developer Centre">
          <span class="icon-chevron-right"></span>
        Plugin Developer Centre</a>
                  </li>
                
      <li>
  
                          <a href="../../repository/index.html" title="Maven Repository Centre">
          <span class="none"></span>
        Maven Repository Centre</a>
            </li>
                
      <li>
  
                          <a href="../../developers/index.html" title="Maven Developer Centre">
          <span class="none"></span>
        Maven Developer Centre</a>
            </li>
                
      <li>
  
                          <a href="../../articles.html" title="Books and Resources">
          <span class="none"></span>
        Books and Resources</a>
            </li>
                
      <li>
  
                          <a href="http://docs.codehaus.org/display/MAVENUSER/Home" class="externalLink" title="Wiki">
          <span class="none"></span>
        Wiki</a>
            </li>
                              <li class="nav-header">Community</li>
                              
      <li>
  
                          <a href="../../community.html" title="Community Overview">
          <span class="none"></span>
        Community Overview</a>
            </li>
                
      <li>
  
                          <a href="../../guides/development/guide-helping.html" title="How to Contribute">
          <span class="none"></span>
        How to Contribute</a>
            </li>
                
      <li>
  
                          <a href="../../guides/mini/guide-maven-evangelism.html" title="Maven Repository">
          <span class="none"></span>
        Maven Repository</a>
            </li>
                
      <li>
  
                          <a href="../../users/getting-help.html" title="Getting Help">
          <span class="none"></span>
        Getting Help</a>
            </li>
                
      <li>
  
                          <a href="../../issue-tracking.html" title="Issue Tracking">
          <span class="none"></span>
        Issue Tracking</a>
            </li>
                
      <li>
  
                          <a href="../../source-repository.html" title="Source Repository">
          <span class="none"></span>
        Source Repository</a>
            </li>
                
      <li>
  
                          <a href="../../team-list.html" title="The Maven Team">
          <span class="none"></span>
        The Maven Team</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                          
      <li>
  
                          <a href="../../project-info.html" title="Project Information">
          <span class="icon-chevron-right"></span>
        Project Information</a>
                  </li>
                              <li class="nav-header">Maven Projects</li>
                              
      <li>
  
                          <a href="../../ant-tasks/index.html" title="Ant Tasks">
          <span class="none"></span>
        Ant Tasks</a>
            </li>
                
      <li>
  
                          <a href="../../archetype/index.html" title="Archetype">
          <span class="none"></span>
        Archetype</a>
            </li>
                
      <li>
  
                          <a href="../../doxia/index.html" title="Doxia">
          <span class="none"></span>
        Doxia</a>
            </li>
                
      <li>
  
                          <a href="../../jxr/index.html" title="JXR">
          <span class="none"></span>
        JXR</a>
            </li>
                
      <li>
  
                          <a href="../../ref/current" title="Maven">
          <span class="none"></span>
        Maven</a>
            </li>
                
      <li>
  
                          <a href="../../pom/index.html" title="Parent POMs">
          <span class="none"></span>
        Parent POMs</a>
            </li>
                
      <li>
  
                          <a href="../../plugins/index.html" title="Plugins">
          <span class="none"></span>
        Plugins</a>
            </li>
                
      <li>
  
                          <a href="../../plugin-testing/index.html" title="Plugin Testing">
          <span class="none"></span>
        Plugin Testing</a>
            </li>
                
      <li>
  
                          <a href="../../plugin-tools/index.html" title="Plugin Tools">
          <span class="none"></span>
        Plugin Tools</a>
            </li>
                
      <li>
  
                          <a href="../../apache-resource-bundles/index.html" title="Resource Bundles">
          <span class="none"></span>
        Resource Bundles</a>
            </li>
                
      <li>
  
                          <a href="../../scm/index.html" title="SCM">
          <span class="none"></span>
        SCM</a>
            </li>
                
      <li>
  
                          <a href="../../shared/index.html" title="Shared Components">
          <span class="none"></span>
        Shared Components</a>
            </li>
                
      <li>
  
                          <a href="../../skins/index.html" title="Skins">
          <span class="none"></span>
        Skins</a>
            </li>
                
      <li>
  
                          <a href="../../surefire/index.html" title="Surefire">
          <span class="none"></span>
        Surefire</a>
            </li>
                
      <li>
  
                          <a href="../../wagon/index.html" title="Wagon">
          <span class="none"></span>
        Wagon</a>
            </li>
                              <li class="nav-header">ASF</li>
                              
      <li>
  
                          <a href="http://www.apache.org/foundation/how-it-works.html" class="externalLink" title="How Apache Works">
          <span class="none"></span>
        How Apache Works</a>
            </li>
                
      <li>
  
                          <a href="http://www.apache.org/foundation/" class="externalLink" title="Foundation">
          <span class="none"></span>
        Foundation</a>
            </li>
                
      <li>
  
                          <a href="http://www.apache.org/foundation/sponsorship.html" class="externalLink" title="Sponsoring Apache">
          <span class="none"></span>
        Sponsoring Apache</a>
            </li>
                
      <li>
  
                          <a href="http://www.apache.org/foundation/thanks.html" class="externalLink" title="Thanks">
          <span class="none"></span>
        Thanks</a>
            </li>
            </ul>
                
                    
                            <form id="search-form" action="https://www.google.com/search" method="get" >
    
  <input value="$sitesearchValue" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="https://www.google.com/coop/cse/brand?form=search-form"></script>
          
          <hr />

           <div id="poweredBy">
                   
    <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>

    
    <div class="g-plusone" data-href="http://maven.apache.org/" data-size="tall" ></div>

                   <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <!-- Licensed to the Apache Software Foundation (ASF) under one --><!-- or more contributor license agreements.  See the NOTICE file --><!-- distributed with this work for additional information --><!-- regarding copyright ownership.  The ASF licenses this file --><!-- to you under the Apache License, Version 2.0 (the --><!-- "License"); you may not use this file except in compliance --><!-- with the License.  You may obtain a copy of the License at --><!--  --><!-- http://www.apache.org/licenses/LICENSE-2.0 --><!--  --><!-- Unless required by applicable law or agreed to in writing, --><!-- software distributed under the License is distributed on an --><!-- "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY --><!-- KIND, either express or implied.  See the License for the --><!-- specific language governing permissions and limitations --><!-- under the License. --><!-- NOTE: For help with the syntax of this file, see: --><!-- http://maven.apache.org/doxia/references/apt-format.html --><!-- NOTE: This guide has been adapted from "Guide to Developing Java Plugins" --><!-- by Bob Allison. --><div class="section">
<h2><a name="Developing_Ant_Plugins_for_Maven_2.x"></a>Developing Ant Plugins for Maven 2.x</h2>
<div class="section">
<h3><a name="Warning"></a>Warning</h3>
<p><b>The documentation below assumes that you have updated your locally cached cached copy of the maven-plugin-plugin. To update your copy, you will need to include the -U option when you build your plugin project:</b></p>
<div class="source"><pre class="prettyprint linenums">mvn -U clean install</pre></div>
<p>The maven-plugin-plugin is responsible for reading plugin metadata in its various forms and writing a standard Maven plugin descriptor based on the input. It was designed to accommodate multiple plugin languages side by side, but its initial design was slightly flawed for plugin languages that don't include the metadata inline with the source (within the same file). Since the 2.0.1 release of Maven, the maven-plugin-plugin has contained revisions to handle this scenario. Since the API has changed (in a backward-compatible way), and since the Ant plugin support requires these changes be in place, you will see an <tt>AbstractMethodError</tt> if you try to build an Ant-based plugin using the old maven-plugin-plugin.</p></div>
<div class="section">
<h3><a name="Introduction"></a>Introduction</h3>
<p>The intent of this document is to help users learn to develop Maven plugins using Ant.</p>
<p>As of the 2.0.1 release, Maven supports Ant-driven plugins. These plugins allow the invocation of Ant targets (specified in scripts embedded in the plugin JAR) at specific points in the build lifecycle. They can also inject parameter values into the Ant project instances when a target is called.</p></div>
<div class="section">
<h3><a name="Conventions"></a>Conventions</h3>
<p>In this guide, we'll use the standard Maven directory structure for projects, to keep our POMs as simple as possible. It's important to note that this is only a standard layout, not a requirement. The important locations for our discussion are the following:</p>
<div class="source"><pre class="prettyprint linenums">  /&lt;project-root&gt;
  |
  +- pom.xml
  |
  +- /src
  |  |
  |  +- /main
  |  |  |
  |  |  +- /scripts (source location for script-driven plugins)
  |  |  |  |
  ...</pre></div></div>
<div class="section">
<h3><a name="Getting_Started"></a>Getting Started</h3>
<p>We'll start with the simplest of all possible plugins. This plugin takes no parameters, and will simply print a message out to the screen when invoked. This should familiarize the reader with the basics of mapping Ant build scripts to the Maven plugin framework. From there, we will gradually increase the complexity of our plugin, adding parameters, interacting with standard project locations, and binding to lifecycle phases. Finally, we'll see how a single Ant build script can be mapped to multiple Maven mojos within the same plugin.</p>
<div class="section">
<h4><a name="Hello_World"></a>Hello, World</h4>
<p>Our first plugin will simply print &quot;Hello, World&quot; to the console.</p>
<div class="section">
<h5><a name="The_Build_Script"></a>The Build Script</h5>
<p>The elemental Ant-driven mojo consists of a simple Ant build script, a mapping metadata file, and of course the plugin's POM. If our goal is to print &quot;Hello, World&quot;, we might use an Ant build script that looks something like this:</p>
<div class="source"><pre class="prettyprint linenums">hello.build.xml:
--------------------------------

&lt;project&gt;
  &lt;target name=&quot;hello&quot;&gt;
    &lt;echo&gt;Hello, World&lt;/echo&gt;
  &lt;/target&gt;
&lt;/project&gt;</pre></div></div>
<div class="section">
<h5><a name="The_Mapping_Document"></a>The Mapping Document</h5>
<p>Once we've created this build script, we need to tell Maven how to use it as a plugin. This involves creating a mapping document. Note that where the build script was named <b>hello.build.xml</b>, the mapping document is named <b>hello.mojos.xml</b>. The naming of these files is very important, as this is how the plugin parser matches mapping documents to build scripts. It has the general form:</p>
<ul>
<li><i>basename</i><b>.build.xml</b> - The Ant build script.</li>
<li><i>basename</i><b>.mojos.xml</b> - The corresponding mapping document.</li></ul>
<p>A simple mapping document used to wire the above build script into Maven's plugin framework might look as follows:</p>
<div class="source"><pre class="prettyprint linenums">hello.mojos.xml:
------------------------------

&lt;pluginMetadata&gt;
  &lt;mojos&gt;
    &lt;mojo&gt;
      &lt;goal&gt;hello&lt;/goal&gt;
        
      &lt;!-- this element refers to the Ant target we'll invoke --&gt;
      &lt;call&gt;hello&lt;/call&gt;
      &lt;description&gt;
        Say Hello, World.
      &lt;/description&gt;
    &lt;/mojo&gt;
  &lt;/mojos&gt;
&lt;/pluginMetadata&gt;</pre></div></div>
<div class="section">
<h5><a name="The_POM"></a>The POM</h5>
<p>Now that we have the build script and mapping document, we're ready to build this plugin. However, in order to build, we need to provide a POM for our new plugin. As it turns out, the POM required for an Ant-driven plugin is fairly complex. This is because we have to configure the maven-plugin-plugin to use the Ant plugin parsing tools in addition to the defaults (such as the Java parsing tools). Our POM might look something like this:</p>
<div class="source"><pre class="prettyprint linenums">pom.xml:
------------------------------

&lt;project&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    
  &lt;groupId&gt;org.myproject.plugins&lt;/groupId&gt;
  &lt;artifactId&gt;hello-plugin&lt;/artifactId&gt;
  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    
  &lt;packaging&gt;maven-plugin&lt;/packaging&gt;
  
  &lt;name&gt;Hello Plugin&lt;/name&gt;
  
  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.maven&lt;/groupId&gt;
      &lt;artifactId&gt;maven-script-ant&lt;/artifactId&gt;
      &lt;version&gt;2.0.6&lt;/version&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;
  
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;!-- NOTE: We don't need groupId if the plugin's groupId is
             org.apache.maven.plugins OR org.codehaus.mojo.
        --&gt;
        &lt;artifactId&gt;maven-plugin-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.5&lt;/version&gt;
        
        &lt;!-- Add the Ant plugin tools --&gt;
        &lt;dependencies&gt;
          &lt;dependency&gt;
            &lt;groupId&gt;org.apache.maven.plugin-tools&lt;/groupId&gt;
            &lt;artifactId&gt;maven-plugin-tools-ant&lt;/artifactId&gt;
            &lt;version&gt;2.5&lt;/version&gt;
          &lt;/dependency&gt;
        &lt;/dependencies&gt;
        
        &lt;!-- Tell the plugin-plugin which prefix we will use.
             Later, we'll configure Maven to allow us to invoke this
             plugin using the &quot;prefix:mojo&quot; shorthand.
        --&gt;
        &lt;configuration&gt;
          &lt;goalPrefix&gt;hello&lt;/goalPrefix&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;</pre></div></div>
<div class="section">
<h5><a name="Build_It_and_Run_It"></a>Build It and Run It</h5>
<p>Once we have a POM for our new plugin, we can install it into the local repository just as we would any other Maven project:</p>
<div class="source"><pre class="prettyprint linenums">mvn install</pre></div>
<p>and invoke it like this:</p>
<div class="source"><pre class="prettyprint linenums">mvn org.myproject.plugins:hello-plugin:hello</pre></div>
<p>This should output the following:</p>
<div class="source"><pre class="prettyprint linenums">[echo] Hello, World</pre></div></div></div></div>
<div class="section">
<h3><a name="Using_prefix:mojo_Invocation_Syntax"></a>Using <b>prefix:mojo</b> Invocation Syntax</h3>
<p>Our new plugin works, but look at that command line... The next thing is to configure Maven so we can use the familiar <b>prefix:mojo</b> invocation syntax, and leave that verbose, fully-qualified mess behind.</p>
<p>As you know, Maven maps plugins to user-friendly prefixes. However, these prefixes might overlap; that is, multiple plugins may try to use the same prefix inadvertently. To avoid the obvious ambiguity associated with such a collision, Maven will search a predetermined list of plugin groupIds for a given prefix, with the first match winning. So, if we want to add our new plugin to this search, we need to configure the list of plugin groupIds.</p>
<div class="section">
<h4><a name="Configuring_Plugin-Prefix_Searching"></a>Configuring Plugin-Prefix Searching</h4>
<p>In order to reference our new plugin by prefix, we need to add its groupId to the <tt>&lt;pluginGroups/&gt;</tt> list in the <tt>settings.xml</tt> file. As you probably know, this file is usually found under $HOME/.m2. The added section to make our plugin's groupId searchable should look like this:</p>
<div class="source"><pre class="prettyprint linenums">~/.m2/settings.xml:
------------------------------

&lt;settings&gt;
  .
  .
  .
  &lt;pluginGroups&gt;
    &lt;pluginGroup&gt;org.myproject.plugins&lt;/pluginGroup&gt;
  &lt;/pluginGroups&gt;
  .
  .
  .
&lt;/settings&gt;</pre></div></div>
<div class="section">
<h4><a name="Run_It"></a>Run It</h4>
<p>We can check that this worked by invoking our new mojo once again, this time using the prefix syntax:</p>
<div class="source"><pre class="prettyprint linenums">mvn hello:hello</pre></div></div></div>
<div class="section">
<h3><a name="Adding_Plugin_Parameters"></a>Adding Plugin Parameters</h3>
<p>Now, suppose it's not enough that our plugin display static text to the console. Suppose we need it to display a greeting that is a little more personalized. We can easily add support for this by adding a <b>name</b> parameter. For good measure, we'll output the current project's name as well.</p>
<div class="section">
<h4><a name="Change_the_Ant_Script"></a>Change the Ant Script</h4>
<p>The build script will have to change to output the new information:</p>
<div class="source"><pre class="prettyprint linenums">hello.build.xml:
--------------------------------

&lt;project&gt;
  &lt;target name=&quot;hello&quot;&gt;
    &lt;echo&gt;Hello, ${name}. You're building project: ${projectName}&lt;/echo&gt;
  &lt;/target&gt;
&lt;/project&gt;</pre></div></div>
<div class="section">
<h4><a name="Change_the_Mapping_Document"></a>Change the Mapping Document</h4>
<p>Now that we have a build script which requires two new parameters, we have to tell the mapping document about them, so they will be injected into the Ant Project instance.</p>
<div class="source"><pre class="prettyprint linenums">hello.mojos.xml:
------------------------------

&lt;pluginMetadata&gt;
  &lt;mojos&gt;
    &lt;mojo&gt;
      &lt;goal&gt;hello&lt;/goal&gt;
      
      &lt;!-- this element refers to the Ant target we'll invoke --&gt;
      &lt;call&gt;hello&lt;/call&gt;
      
      &lt;requiresProject&gt;true&lt;/requiresProject&gt;
      
      &lt;description&gt;
        Say Hello, including the user's name, and print the project name to the console.
      &lt;/description&gt;
      &lt;parameters&gt;
        &lt;parameter&gt;
          &lt;name&gt;name&lt;/name&gt; 
          &lt;property&gt;name&lt;/property&gt; 
          &lt;required&gt;true&lt;/required&gt; 
          &lt;expression&gt;${name}&lt;/expression&gt;
          &lt;type&gt;java.lang.String&lt;/type&gt;
          &lt;description&gt;The name of the user to greet.&lt;/description&gt;
        &lt;/parameter&gt;
        
        &lt;parameter&gt;
          &lt;name&gt;projectName&lt;/name&gt; 
          &lt;property&gt;projectName&lt;/property&gt;
          &lt;required&gt;true&lt;/required&gt;
          &lt;readonly&gt;true&lt;/readonly&gt;
          &lt;defaultValue&gt;${project.name}&lt;/defaultValue&gt;
          &lt;type&gt;java.lang.String&lt;/type&gt;
          &lt;description&gt;The name of the project currently being built.&lt;/description&gt;
        &lt;/parameter&gt;
      &lt;/parameters&gt;
    &lt;/mojo&gt;
  &lt;/mojos&gt;
&lt;/pluginMetadata&gt;</pre></div>
<p>You'll notice several differences from the old version of the mapping document. First, we've added <b>requiresProject=&quot;true&quot;</b> to the mojo declaration. This tells Maven that our mojo requires a valid project before it can execute. In our case, we need a project so we can determine the correct <b>projectName</b> to use. Next, we've added two parameter declarations to our mojo mapping; one for <b>name</b> and another for <b>projectName</b>.</p>
<p>The <b>name</b> parameter declaration provides an expression attribute. This allows the user to specify <tt>-Dname=somename</tt> on the command line. Otherwise, the only way to configure this parameter would be through a <tt>&lt;configuration/&gt;</tt> element within the plugin specification in the user's POM. Note that this parameter is required to have a value before our mojo can execute.</p>
<p>The <b>projectName</b> parameter declaration provides two other interesting items. First, it specifies a <tt>defaultValue</tt> attribute, which specifies an expression to be evaluated against Maven's current build state in order to extract the parameter's value. Second, it specifies a <tt>readonly</tt> attribute, which means the user cannot directly configure this parameter - either via command line or configuration within the POM. It can only be modified by modifying the build state referenced in the <tt>defaultValue</tt>. In our case, the name element of the POM. Also note that this parameter is declared to be required before our mojo can execute.</p></div>
<div class="section">
<h4><a name="Rebuild_It_and_Run_It"></a>Rebuild It and Run It</h4>
<p>Now that we've modified our plugin, we have to rebuild it before running it again.</p>
<div class="source"><pre class="prettyprint linenums">mvn clean install</pre></div>
<p>Next, we should run the plugin again to verify that it's doing what we expect. However, before we can run it, we have some requirements to satisfy. First, we have to be sure we're executing in the context of a valid Maven POM...runnning in the plugin's own project directory should satisfy that requirement. Then, we have to satisfy the name requirement. We can do this directly through the command line. So, the resulting invocation of our plugin will look like this:</p>
<div class="source"><pre class="prettyprint linenums">mvn -Dname=&lt;your-name-here&gt; hello:hello</pre></div>
<p>or, in my case:</p>
<div class="source"><pre class="prettyprint linenums">mvn -Dname=John hello:hello</pre></div>
<p>This should output the following:</p>
<div class="source"><pre class="prettyprint linenums">[echo] Hello, John. You're building project: Hello Plugin</pre></div></div></div>
<div class="section">
<h3><a name="Defining_Multiple_Mojos_from_One_Build_Script"></a>Defining Multiple Mojos from One Build Script</h3>
<p>If you're familiar with Ant, you're probably familiar with the common usage pattern of defining multiple build types within a single build script. For instance, you might have a build type for cleaning the project, another for producing the application JAR file, and yet another for producing the full distribution including Javadocs, etc.</p>
<p>The concept is pretty simple. Discrete chunks of the build process are separated into targets within the script. These targets can reference one another in order to make reuse within the build script possible.</p>
<p>These same concepts map pretty well to Maven, actually. However, instead of targets directly referencing one another, they would be bound to the appropriate phases of the build lifecycle. In this way, multiple Ant targets from the same build script can be reused piecemeal at different points in multiple build lifecycles (clean, site, and the main lifecycle are three examples).</p>
<p>This section will describe how to map multiple logical mojos onto different targets within the same Ant build script. It's also possible to reference targets from multiple build scripts, but we'll cover this later.</p>
<div class="section">
<h4><a name="Two_Targets_One_Script"></a>Two Targets, One Script</h4>
<p>To test this, we'll split our echo statement into two targets. Then, we'll reference each as separate mojos in the build. The new script looks like this:</p>
<div class="source"><pre class="prettyprint linenums">one-two.build.xml:
--------------------------------

&lt;project&gt;
  &lt;target name=&quot;one&quot;&gt;
    &lt;echo&gt;Hello, ${name}.&lt;/echo&gt;
  &lt;/target&gt;
  
  &lt;target name=&quot;two&quot;&gt;
    &lt;echo&gt;You're building project: ${projectName}&lt;/echo&gt;
  &lt;/target&gt;
&lt;/project&gt;</pre></div></div>
<div class="section">
<h4><a name="Map_the_Mojos"></a>Map the Mojos</h4>
<p>Next, we'll add new mapping document to map these two new mojos:</p>
<div class="source"><pre class="prettyprint linenums">one-two.mojos.xml:
------------------------------

&lt;pluginMetadata&gt;
  &lt;mojos&gt;
    &lt;mojo&gt;
      &lt;goal&gt;one&lt;/goal&gt;
      
      &lt;!-- this element refers to the Ant target we'll invoke --&gt;
      &lt;call&gt;one&lt;/call&gt;
      
      &lt;description&gt;
        Say Hello. Include the user's name.
      &lt;/description&gt;
      &lt;parameters&gt;
        &lt;parameter&gt;
          &lt;name&gt;name&lt;/name&gt; 
          &lt;property&gt;name&lt;/property&gt; 
          &lt;required&gt;true&lt;/required&gt; 
          &lt;expression&gt;${name}&lt;/expression&gt;
          &lt;type&gt;java.lang.String&lt;/type&gt;
          &lt;description&gt;The name of the user to greet.&lt;/description&gt;
        &lt;/parameter&gt;
      &lt;/parameters&gt;
    &lt;/mojo&gt;
        
    &lt;mojo&gt;
      &lt;goal&gt;two&lt;/goal&gt;
      
      &lt;!-- this element refers to the Ant target we'll invoke --&gt;
      &lt;call&gt;two&lt;/call&gt;
      &lt;requiresProject&gt;true&lt;/requiresProject&gt;
      
      &lt;description&gt;
        Write the project name to the console.
      &lt;/description&gt;
      &lt;parameters&gt;
        &lt;parameter&gt;
          &lt;name&gt;projectName&lt;/name&gt; 
          &lt;property&gt;projectName&lt;/property&gt;
          &lt;required&gt;true&lt;/required&gt;
          &lt;readonly&gt;true&lt;/readonly&gt;
          &lt;defaultValue&gt;${project.name}&lt;/defaultValue&gt;
          &lt;type&gt;java.lang.String&lt;/type&gt;
          &lt;description&gt;The name of the project currently being built.&lt;/description&gt;
        &lt;/parameter&gt;
      &lt;/parameters&gt;
    &lt;/mojo&gt;
  &lt;/mojos&gt;
&lt;/pluginMetadata&gt;</pre></div>
<p>Now that we've split the old functionality into two distinct mojos, there are some interesting consequences. Aside from the obvious, mojo <b>one</b> no longer requires a valid project instance in order to execute, since we only require the user's name in order to greet him.</p></div>
<div class="section">
<h4><a name="Build_It_Run_It"></a>Build It, Run It</h4></div>
<div class="section">
<h4><a name="Rebuild_It_and_Run_It"></a>Rebuild It and Run It</h4>
<p>Since we've modified our plugin, we have to rebuild it again before re-running it.</p>
<div class="source"><pre class="prettyprint linenums">mvn clean install</pre></div>
<p>Now that we have two separate mojos, we can execute them singly, or in any order we choose. We can bind them to phases of the lifecycle using plugin configuration inside the build element of a POM. We can execute them like this:</p>
<div class="source"><pre class="prettyprint linenums">mvn -Dname=John hello:one

RETURNS:

[echo] Hello, John.


mvn hello:two (executed in the plugin's project directory)

RETURNS:

[echo] You're building project: Hello Plugin</pre></div>
<p>Alternatively, you could build a POM like this:</p>
<div class="source"><pre class="prettyprint linenums">test-project/pom.xml:
----------------------------

&lt;project&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;groupId&gt;org.myproject.tests&lt;/groupId&gt;
  &lt;artifactId&gt;hello-plugin-tests&lt;/artifactId&gt;
  &lt;version&gt;1.0&lt;/version&gt;
  
  &lt;name&gt;Test Project&lt;/name&gt;
  
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.myproject.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;hello-plugin&lt;/artifactId&gt;
        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
        
        &lt;configuration&gt;
          &lt;name&gt;John&lt;/name&gt;
        &lt;/configuration&gt;
        
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;phase&gt;validate&lt;/phase&gt;
            &lt;goals&gt;
              &lt;goal&gt;one&lt;/goal&gt;
              &lt;goal&gt;two&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;</pre></div>
<p>Then, simply call Maven on this new POM:</p>
<div class="source"><pre class="prettyprint linenums">cd test-project
mvn validate</pre></div>
<p>You should see the following output:</p>
<div class="source"><pre class="prettyprint linenums">[echo] Hello, John.
...
[echo] You're building project: Test Project</pre></div></div>
<div class="section">
<h4><a name="A_Note_on_Multiple_Build_Scripts"></a>A Note on Multiple Build Scripts</h4>
<p>It's worth mentioning that Ant-driven plugins can just as easily contain multiple Ant build scripts. Simply follow the naming rules - naming each <tt>A.build.xml</tt>, <tt>B.build.xml</tt>, <tt>C.build.xml</tt>, etc. for example - and be sure to provide a mapping document to correspond to each build script that contains a mojo (other build scripts may be contained in the plugin, and referenced by one of these; they don't need mapping documents). So, for the above examples (assuming they all contained mojo targets), you'd need: <tt>A.mojos.xml</tt>, <tt>B.mojos.xml</tt>, and <tt>C.mojos.xml</tt>. If <tt>C.build.xml</tt> was referenced by A and B, but didn't contain mojo targets, then you don't need a <tt>C.mojos.xml</tt> for obvious reasons.</p></div></div>
<div class="section">
<h3><a name="Advanced_Usage"></a>Advanced Usage</h3>
<p>Below are some tips on some of the more advanced options related to Ant mojos.</p>
<div class="section">
<h4><a name="Component_References"></a>Component References</h4>
<p>If your plugin needs a reference to a Plexus component, it will have to define something similar to the following in the mapping document:</p>
<div class="source"><pre class="prettyprint linenums">&lt;pluginMetadata&gt;
  &lt;mojos&gt;
    &lt;mojo&gt;
      .
      .
      .
      &lt;components&gt;
        &lt;component&gt;
          &lt;role&gt;org.apache.maven.project.MavenProjectBuilder&lt;/role&gt;
          &lt;hint&gt;default&lt;/hint&gt; &lt;!-- This is optional --&gt;
        &lt;/component&gt;
      &lt;/components&gt;
      .
      .
      .
    &lt;/mojo&gt;
  &lt;/mojos&gt;
&lt;/pluginMetadata&gt;</pre></div></div>
<div class="section">
<h4><a name="Forking_New_Lifecycles"></a>Forking New Lifecycles</h4>
<p>In case your plugin needs to fork a new lifecycle, you can include the following in the mapping document:</p>
<div class="source"><pre class="prettyprint linenums">&lt;pluginMetadata&gt;
  &lt;mojos&gt;
    &lt;mojo&gt;
      .
      .
      .
      &lt;execute&gt;
        &lt;lifecycle&gt;my-custom-lifecycle&lt;/lifecycle&gt;
        &lt;phase&gt;package&lt;/phase&gt;
        
        &lt;!-- OR --&gt;
        
        &lt;goal&gt;some:goal&lt;/goal&gt;
      &lt;/execute&gt;
      .
      .
      .
    &lt;/mojo&gt;
  &lt;/mojos&gt;
&lt;/pluginMetadata&gt;</pre></div></div>
<div class="section">
<h4><a name="Deprecation"></a>Deprecation</h4>
<p>As time goes on, you will likely have to deprecate part of your plugin. Whether it's a mojo parameter, or even an entire mojo, Maven can support it, and remind your users that the mojo or configuration they're using is deprecated, and print a message directing them to adjust their usage.</p>
<p>To deprecate a mojo parameter, simply add this:</p>
<div class="source"><pre class="prettyprint linenums">&lt;pluginMetadata&gt;
  &lt;mojos&gt;
    &lt;mojo&gt;
      .
      .
      .
      &lt;parameters&gt;
        &lt;parameter&gt;
          .
          .
          .
          &lt;deprecated&gt;Use this other parameter instead.&lt;/deprecated&gt;
          .
          .
          .
        &lt;/parameter&gt;
      &lt;/parameters&gt;
      .
      .
      .
    &lt;/mojo&gt;
  &lt;/mojos&gt;
&lt;/pluginMetadata&gt;</pre></div>
<p>To deprecate an entire mojo, add this:</p>
<div class="source"><pre class="prettyprint linenums">&lt;pluginMetadata&gt;
  &lt;mojos&gt;
    &lt;mojo&gt;
      .
      .
      .
      &lt;deprecated&gt;Use this other mojo instead.&lt;/deprecated&gt;
      .
      .
      .
    &lt;/mojo&gt;
  &lt;/mojos&gt;
&lt;/pluginMetadata&gt;</pre></div></div></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                    2002&#x2013;2015
                        <a href="http://www.apache.org/">The Apache Software Foundation</a>.
            All rights reserved.      
                    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
