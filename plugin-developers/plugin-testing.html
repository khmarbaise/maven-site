<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2015-04-05 
 | Rendered using Apache Maven Fluido Skin 1.4-SNAPSHOT
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Vincent Siveton" />
    <meta name="Date-Creation-yyyymmdd" content="20080101" />
    <meta name="Date-Revision-yyyymmdd" content="20150405" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Maven &#x2013; Developers centre - Testing Plugins Strategies</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.4-SNAPSHOT.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.4-SNAPSHOT.min.js"></script>

                          
        
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script>
                      
        
<script type="text/javascript">_uacct = "UA-140879-1";
        urchinTracker();</script>
          
                  </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="http://www.apache.org/" id="bannerLeft">
                                                                                                <img src="../images/apache-maven-project.png" />
                </a>
                      </div>
        <div class="pull-right">                                <a href=".././" id="bannerRight">
                                                                                                <img src="../images/maven-logo-black-on-white.png" />
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                              <li class="">
                    <a href="http://www.apache.org/" class="externalLink" title="Apache">
        Apache</a>
                    <span class="divider">/</span>
      </li>
            <li class="">
                    <a href="../index.html" title="Maven">
        Maven</a>
                    <span class="divider">/</span>
      </li>
        <li class="active ">Developers centre - Testing Plugins Strategies</li>
        
                
                    
                  <li id="publishDate" class="pull-right">Last Published: 2015-04-05</li>
            
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Main</li>
                              
      <li>
  
                          <a href="../index.html" title="Welcome">
          <span class="none"></span>
        Welcome</a>
            </li>
                              <li class="nav-header">Get Maven</li>
                              
      <li>
  
                          <a href="../download.html" title="Download">
          <span class="none"></span>
        Download</a>
            </li>
                
      <li>
  
                          <a href="../docs/history.html" title="Releases History">
          <span class="none"></span>
        Releases History</a>
            </li>
                
      <li>
  
                          <a href="../docs/3.3.1/release-notes.html" title="Release Notes (3.3.1)">
          <span class="none"></span>
        Release Notes (3.3.1)</a>
            </li>
                
      <li>
  
                          <a href="../docs/3.2.5/release-notes.html" title="Release Notes (3.2.5)">
          <span class="none"></span>
        Release Notes (3.2.5)</a>
            </li>
                
      <li>
  
                          <a href="../docs/3.1.1/release-notes.html" title="Release Notes (3.1.1)">
          <span class="none"></span>
        Release Notes (3.1.1)</a>
            </li>
                
      <li>
  
                          <a href="../docs/3.0.5/release-notes.html" title="Release Notes (3.0.5)">
          <span class="none"></span>
        Release Notes (3.0.5)</a>
            </li>
                
      <li>
  
                          <a href="../release-notes-all.html" title="All Release Notes">
          <span class="none"></span>
        All Release Notes</a>
            </li>
                
      <li>
  
                          <a href="http://www.apache.org/licenses/" class="externalLink" title="License">
          <span class="none"></span>
        License</a>
            </li>
                
      <li>
  
                          <a href="../security.html" title="Security">
          <span class="none"></span>
        Security</a>
            </li>
                              <li class="nav-header">IDE Integration</li>
                              
      <li>
  
                          <a href="../eclipse-plugin.html" title="Eclipse">
          <span class="none"></span>
        Eclipse</a>
            </li>
                
      <li>
  
                          <a href="../netbeans-module.html" title="NetBeans">
          <span class="none"></span>
        NetBeans</a>
            </li>
                              <li class="nav-header">About Maven</li>
                              
      <li>
  
                          <a href="../what-is-maven.html" title="What is Maven?">
          <span class="none"></span>
        What is Maven?</a>
            </li>
                
      <li>
  
                          <a href="../maven-features.html" title="Features">
          <span class="none"></span>
        Features</a>
            </li>
                
      <li>
  
                          <a href="../general.html" title="FAQ (official)">
          <span class="none"></span>
        FAQ (official)</a>
            </li>
                
      <li>
  
                          <a href="http://docs.codehaus.org/display/MAVENUSER/FAQs-1" class="externalLink" title="FAQ (unofficial)">
          <span class="none"></span>
        FAQ (unofficial)</a>
            </li>
                
      <li>
  
                          <a href="../support-and-training.html" title="Support and Training">
          <span class="none"></span>
        Support and Training</a>
            </li>
                              <li class="nav-header">Documentation</li>
                              
      <li>
  
                          <a href="../plugins/index.html" title="Maven Plugins">
          <span class="none"></span>
        Maven Plugins</a>
            </li>
                
      <li>
  
                          <a href="../guides/index.html" title="Index (category)">
          <span class="none"></span>
        Index (category)</a>
            </li>
                
      <li>
  
                          <a href="../run-maven/index.html" title="Running Maven">
          <span class="none"></span>
        Running Maven</a>
            </li>
                                                                                                                                          
      <li>
  
                          <a href="../users/index.html" title="User Centre">
          <span class="icon-chevron-right"></span>
        User Centre</a>
                  </li>
                                                                                                      
      <li>
  
                          <a href="../plugin-developers/index.html" title="Plugin Developer Centre">
          <span class="icon-chevron-right"></span>
        Plugin Developer Centre</a>
                  </li>
                
      <li>
  
                          <a href="../repository/index.html" title="Maven Repository Centre">
          <span class="none"></span>
        Maven Repository Centre</a>
            </li>
                
      <li>
  
                          <a href="../developers/index.html" title="Maven Developer Centre">
          <span class="none"></span>
        Maven Developer Centre</a>
            </li>
                
      <li>
  
                          <a href="../articles.html" title="Books and Resources">
          <span class="none"></span>
        Books and Resources</a>
            </li>
                
      <li>
  
                          <a href="http://docs.codehaus.org/display/MAVENUSER/Home" class="externalLink" title="Wiki">
          <span class="none"></span>
        Wiki</a>
            </li>
                              <li class="nav-header">Community</li>
                              
      <li>
  
                          <a href="../community.html" title="Community Overview">
          <span class="none"></span>
        Community Overview</a>
            </li>
                
      <li>
  
                          <a href="../guides/development/guide-helping.html" title="How to Contribute">
          <span class="none"></span>
        How to Contribute</a>
            </li>
                
      <li>
  
                          <a href="../guides/mini/guide-maven-evangelism.html" title="Maven Repository">
          <span class="none"></span>
        Maven Repository</a>
            </li>
                
      <li>
  
                          <a href="../users/getting-help.html" title="Getting Help">
          <span class="none"></span>
        Getting Help</a>
            </li>
                
      <li>
  
                          <a href="../issue-tracking.html" title="Issue Tracking">
          <span class="none"></span>
        Issue Tracking</a>
            </li>
                
      <li>
  
                          <a href="../source-repository.html" title="Source Repository">
          <span class="none"></span>
        Source Repository</a>
            </li>
                
      <li>
  
                          <a href="../team-list.html" title="The Maven Team">
          <span class="none"></span>
        The Maven Team</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                          
      <li>
  
                          <a href="../project-info.html" title="Project Information">
          <span class="icon-chevron-right"></span>
        Project Information</a>
                  </li>
                              <li class="nav-header">Maven Projects</li>
                              
      <li>
  
                          <a href="../ant-tasks/index.html" title="Ant Tasks">
          <span class="none"></span>
        Ant Tasks</a>
            </li>
                
      <li>
  
                          <a href="../archetype/index.html" title="Archetype">
          <span class="none"></span>
        Archetype</a>
            </li>
                
      <li>
  
                          <a href="../doxia/index.html" title="Doxia">
          <span class="none"></span>
        Doxia</a>
            </li>
                
      <li>
  
                          <a href="../jxr/index.html" title="JXR">
          <span class="none"></span>
        JXR</a>
            </li>
                
      <li>
  
                          <a href="../ref/current" title="Maven">
          <span class="none"></span>
        Maven</a>
            </li>
                
      <li>
  
                          <a href="../pom/index.html" title="Parent POMs">
          <span class="none"></span>
        Parent POMs</a>
            </li>
                
      <li>
  
                          <a href="../plugins/index.html" title="Plugins">
          <span class="none"></span>
        Plugins</a>
            </li>
                
      <li>
  
                          <a href="../plugin-testing/index.html" title="Plugin Testing">
          <span class="none"></span>
        Plugin Testing</a>
            </li>
                
      <li>
  
                          <a href="../plugin-tools/index.html" title="Plugin Tools">
          <span class="none"></span>
        Plugin Tools</a>
            </li>
                
      <li>
  
                          <a href="../apache-resource-bundles/index.html" title="Resource Bundles">
          <span class="none"></span>
        Resource Bundles</a>
            </li>
                
      <li>
  
                          <a href="../scm/index.html" title="SCM">
          <span class="none"></span>
        SCM</a>
            </li>
                
      <li>
  
                          <a href="../shared/index.html" title="Shared Components">
          <span class="none"></span>
        Shared Components</a>
            </li>
                
      <li>
  
                          <a href="../skins/index.html" title="Skins">
          <span class="none"></span>
        Skins</a>
            </li>
                
      <li>
  
                          <a href="../surefire/index.html" title="Surefire">
          <span class="none"></span>
        Surefire</a>
            </li>
                
      <li>
  
                          <a href="../wagon/index.html" title="Wagon">
          <span class="none"></span>
        Wagon</a>
            </li>
                              <li class="nav-header">ASF</li>
                              
      <li>
  
                          <a href="http://www.apache.org/foundation/how-it-works.html" class="externalLink" title="How Apache Works">
          <span class="none"></span>
        How Apache Works</a>
            </li>
                
      <li>
  
                          <a href="http://www.apache.org/foundation/" class="externalLink" title="Foundation">
          <span class="none"></span>
        Foundation</a>
            </li>
                
      <li>
  
                          <a href="http://www.apache.org/foundation/sponsorship.html" class="externalLink" title="Sponsoring Apache">
          <span class="none"></span>
        Sponsoring Apache</a>
            </li>
                
      <li>
  
                          <a href="http://www.apache.org/foundation/thanks.html" class="externalLink" title="Thanks">
          <span class="none"></span>
        Thanks</a>
            </li>
            </ul>
                
                    
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <!-- Licensed to the Apache Software Foundation (ASF) under one --><!-- or more contributor license agreements.  See the NOTICE file --><!-- distributed with this work for additional information --><!-- regarding copyright ownership.  The ASF licenses this file --><!-- to you under the Apache License, Version 2.0 (the --><!-- "License"); you may not use this file except in compliance --><!-- with the License.  You may obtain a copy of the License at --><!--  --><!-- http://www.apache.org/licenses/LICENSE-2.0 --><!--  --><!-- Unless required by applicable law or agreed to in writing, --><!-- software distributed under the License is distributed on an --><!-- "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY --><!-- KIND, either express or implied.  See the License for the --><!-- specific language governing permissions and limitations --><!-- under the License. --><!-- NOTE: For help with the syntax of this file, see: --><!-- http://maven.apache.org/doxia/references/apt-format.html --><div class="section">
<h2><a name="Introduction"></a>Introduction</h2>
<p>Currently, Maven only supports unit testing out of the box. This document is intended to help Maven Developers to test Plugins with Unit Tests, Integration Tests or Functional tests.</p>
<p><b>Note: There are a lot of different ways to test a Maven plugin.</b> For a review of different strategies and tools, please refer to <a class="externalLink" href="http://docs.codehaus.org/display/MAVENUSER/Review+of+Plugin+Testing+Strategies">Review of Plugin Testing Strategies</a></p></div>
<div class="section">
<h2><a name="Testing_Styles:_Unit_Testing_vs._FunctionalIntegration_Testing"></a>Testing Styles: Unit Testing vs. Functional/Integration Testing</h2>
<p>A unit test attempts to verify a mojo as an isolated unit, by mocking out the rest of the Maven environment. A mojo unit test does not attempt to run your plugin in the context of a real Maven build. Unit tests are designed to be fast.</p>
<p>A functional/integration test attempts to use a mojo in a real Maven build, by launching a real instance of Maven in a real project. Normally this requires you to construct special dummy Maven projects with real POM files. Often this requires you to have already installed your plugin into your local repository so it can be used in a real Maven build. Functional tests run much more slowly than unit tests, but they can catch bugs that you may not catch with unit tests.</p>
<p>The general wisdom is that your code should be mostly tested with unit tests, but should also have some functional tests.</p></div>
<div class="section">
<h2><a name="Unit_Tests"></a>Unit Tests</h2>
<div class="section">
<h3><a name="Using_JUnit_alone"></a>Using JUnit alone</h3>
<p>In principle, you can write a unit test of a plugin Mojo the same way you'd write any other JUnit test case, by writing a class that <tt>extends TestCase</tt>.</p>
<p>However, most mojos need more information to work properly. For example, you'll probably need to inject a reference to a MavenProject, so your mojo can query project variables.</p></div>
<div class="section">
<h3><a name="Using_PlexusTestCase"></a>Using PlexusTestCase</h3>
<p>Mojo variables are injected using Plexus, and many Mojos are written to take specific advantage of the Plexus container (by executing a lifecycle or having various injected dependencies).</p>
<p>If you all you need is Plexus container services, you can write your class with <tt>extends PlexusTestCase</tt> instead of TestCase.</p>
<p>With that said, if you need to inject Maven objects into your mojo, you'll probably prefer to use the maven-plugin-testing-harness.</p></div>
<div class="section">
<h3><a name="maven-plugin-testing-harness"></a>maven-plugin-testing-harness</h3>
<p>The <a href="/plugin-testing/maven-plugin-testing-harness/">maven-plugin-testing-harness</a> is explicitly intended to test the <tt>org.apache.maven.reporting.AbstractMavenReport#execute()</tt> implementation.</p>
<p>In general, you need to include <tt>maven-plugin-testing-harness</tt> as dependency, and create a *MojoTest (by convention) class which <tt>extends AbstractMojoTestCase</tt>.</p>
<div class="source"><pre class="prettyprint">...
  &lt;dependencies&gt;
    ...
    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.maven.plugin-testing&lt;/groupId&gt;
      &lt;artifactId&gt;maven-plugin-testing-harness&lt;/artifactId&gt;
      &lt;version&gt;3.3.0&lt;/version&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    ...
  &lt;/dependencies&gt;
...</pre></div>
<div class="source"><pre class="prettyprint">public class YourMojoTest
    extends AbstractMojoTestCase
{
    /**
     * @see junit.framework.TestCase#setUp()
     */
    protected void setUp() throws Exception
    {
        // required for mojo lookups to work
        super.setUp();
    }

    /**
     * @throws Exception
     */
    public void testMojoGoal() throws Exception
    {
        File testPom = new File( getBasedir(),
          &quot;src/test/resources/unit/basic-test/basic-test-plugin-config.xml&quot; );

        YourMojo mojo = (YourMojo) lookupMojo( &quot;yourGoal&quot;, testPom );

        assertNotNull( mojo );
    }
}</pre></div>
<p>For more information, please refer to <a class="externalLink" href="http://cwiki.apache.org/confluence/display/MAVENOLD/Maven+Plugin+Harness">Maven Plugin Harness Wiki</a></p></div></div>
<div class="section">
<h2><a name="IntegrationFunctional_testing"></a>Integration/Functional testing</h2>
<div class="section">
<h3><a name="maven-verifier"></a>maven-verifier</h3>
<p>maven-verifier tests are run using JUnit or TestNG, and provide a simple class allowing you to launch Maven and assert on its log file and built artifacts. It also provides a ResourceExtractor, which extracts a Maven project from your src/test/resources directory into a temporary working directory where you can do tricky stuff with it.</p>
<p>Maven itself uses maven-verifier to run its core integration tests. For more information, please refer to <a class="externalLink" href="http://cwiki.apache.org/confluence/display/MAVENOLD/Creating+a+Maven+Integration+Test">Creating a Maven Integration Test</a>.</p>
<div class="source"><pre class="prettyprint">public class TrivialMavenVerifierTest extends TestCase
{
    public void testMyPlugin()
        throws Exception
    {
        // Check in your dummy Maven project in /src/test/resources/...
        // The testdir is computed from the location of this
        // file.
        File testDir = ResourceExtractor.simpleExtractResources( getClass(), &quot;/my-dummy-maven-project&quot; );

        Verifier verifier;

        /*
         * We must first make sure that any artifact created
         * by this test has been removed from the local
         * repository. Failing to do this could cause
         * unstable test results. Fortunately, the verifier
         * makes it easy to do this.
         */
        verifier = new Verifier( testDir.getAbsolutePath() );
        verifier.deleteArtifact( &quot;org.apache.maven.its.itsample&quot;, &quot;parent&quot;, &quot;1.0&quot;, &quot;pom&quot; );
        verifier.deleteArtifact( &quot;org.apache.maven.its.itsample&quot;, &quot;checkstyle-test&quot;, &quot;1.0&quot;, &quot;jar&quot; );
        verifier.deleteArtifact( &quot;org.apache.maven.its.itsample&quot;, &quot;checkstyle-assembly&quot;, &quot;1.0&quot;, &quot;jar&quot; );

        /*
         * The Command Line Options (CLI) are passed to the
         * verifier as a list. This is handy for things like
         * redefining the local repository if needed. In
         * this case, we use the -N flag so that Maven won't
         * recurse. We are only installing the parent pom to
         * the local repo here.
         */
        List cliOptions = new ArrayList();
        cliOptions.add( &quot;-N&quot; );
        verifier.executeGoal( &quot;install&quot; );

        /*
         * This is the simplest way to check a build
         * succeeded. It is also the simplest way to create
         * an IT test: make the build pass when the test
         * should pass, and make the build fail when the
         * test should fail. There are other methods
         * supported by the verifier. They can be seen here:
         * http://maven.apache.org/shared/maven-verifier/apidocs/index.html
         */
        verifier.verifyErrorFreeLog();

        /*
         * Reset the streams before executing the verifier
         * again.
         */
        verifier.resetStreams();

        /*
         * The verifier also supports beanshell scripts for
         * verification of more complex scenarios. There are
         * plenty of examples in the core-it tests here:
         * http://svn.apache.org/repos/asf/maven/core-integration-testing/trunk
         */
    }</pre></div>
<p><b>Note</b>: maven-verifier and maven-verifier-plugin sound similar, but are totally different unrelated pieces of code. maven-verifier-plugin simply verifies the existence/absence of files on the filesystem. You could use it for functional testing, but you may need more features than maven-verifier-plugin provides.</p></div>
<div class="section">
<h3><a name="maven-invoker-plugin"></a>maven-invoker-plugin</h3>
<p>You can use <a class="externalLink" href="https://svn.apache.org/repos/asf/maven/plugins/trunk/maven-invoker-plugin/">maven-invoker-plugin</a> to invoke Maven and to provide some BeanShell tests. Tests written in this way don't run under JUnit/TestNG; instead, they're run by Maven itself.</p>
<div class="source"><pre class="prettyprint">&lt;project
  xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0
                      http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
  ...
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-invoker-plugin&lt;/artifactId&gt;
        &lt;version&gt;1.9&lt;/version&gt;
        &lt;configuration&gt;
          &lt;projectsDirectory&gt;src/it&lt;/projectsDirectory&gt;
          &lt;pomIncludes&gt;
            &lt;pomInclude&gt;**/pom.xml&lt;/pomInclude&gt;
          &lt;/pomIncludes&gt;
          &lt;postBuildHookScript&gt;verify&lt;/postBuildHookScript&gt;
        &lt;/configuration&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;goals&gt;
              &lt;goal&gt;run&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
      ...
    &lt;/plugins&gt;
  &lt;/build&gt;
  ...
&lt;/project&gt;</pre></div></div>
<div class="section">
<h3><a name="shitty-maven-plugin"></a>shitty-maven-plugin</h3>
<p>The <a class="externalLink" href="http://mojo.codehaus.org/shitty-maven-plugin/">shitty-maven-plugin</a> (Super Helpful Integration Testing ThingY) provides a simple way to run integration tests for a project (single module or multi-module).</p>
<p>shitty-maven-plugin does many of the same things as the maven-invoker-plugin (it supports Groovy tests instead of BeanShell tests), though it has some features that aren't available in maven-invoker-plugin. Notably, it provides some advanced setup steps to automatically install your plugin using a special version name (&quot;TESTING&quot;), so your dummy projects can depend on that version explicitly.</p></div>
<div class="section">
<h3><a name="maven-it-plugin"></a>maven-it-plugin</h3>
<p><b>Note</b>: maven-it-plugin is not at 1.0 yet. Use it at your own risk.</p>
<p>The <a class="externalLink" href="https://svn.apache.org/repos/asf/maven/sandbox/trunk/plugins/maven-it-plugin/">maven-it-plugin</a> is used directly in the <tt>integration-test</tt> phase.</p>
<p><b>Note</b>: this it plugin can not be used to test a plugin that is being built for the first time (i.e. with no release). In this case, you could, for instance, defined an it-snapshot of the plugin with <tt>maven-install-plugin</tt>. during the <tt>pre-integration-test</tt> phase.</p>
<div class="source"><pre class="prettyprint">&lt;project
  xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0
                      http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
  ...
  &lt;artifactId&gt;maven-XXX-plugin&lt;/artifactId&gt;
  &lt;packaging&gt;maven-plugin&lt;/packaging&gt;
  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
  &lt;description&gt;Test Report plugin in the site phase&lt;/description&gt;
  ...
  &lt;build&gt;
    &lt;plugins&gt;
      ...
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-it-plugin&lt;/artifactId&gt;
        &lt;version&gt;1.0-alpha-1-SNAPSHOT&lt;/version&gt;
        &lt;configuration&gt;
          &lt;integrationTestsDirectory&gt;${project.basedir}/src/it&lt;/integrationTestsDirectory&gt;
          &lt;includes&gt;
            &lt;include&gt;**/pom.xml&lt;/include&gt;
          &lt;/includes&gt;
          &lt;goals&gt;site&lt;/goals&gt;
        &lt;/configuration&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;phase&gt;integration-test&lt;/phase&gt;
            &lt;goals&gt;
              &lt;goal&gt;test&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;

      &lt;!-- Need to install IT snapshot of maven-XXX-plugin --&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-install-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.2-SNAPSHOT&lt;/version&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;id&gt;it-test&lt;/id&gt;
            &lt;phase&gt;pre-integration-test&lt;/phase&gt;
            &lt;goals&gt;
              &lt;goal&gt;install-file&lt;/goal&gt;
            &lt;/goals&gt;
            &lt;configuration&gt;
              &lt;file&gt;${project.build.directory}/maven-XXX-plugin-1.0-SNAPSHOT.jar&lt;/file&gt;
              &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
              &lt;artifactId&gt;maven-XXX-plugin&lt;/artifactId&gt;
              &lt;version&gt;1.0-it-SNAPSHOT&lt;/version&gt; &lt;!-- IT SNAPSHOT --&gt;
              &lt;packaging&gt;maven-plugin&lt;/packaging&gt;
              &lt;pomFile&gt;${project.basedir}/pom.xml&lt;/pomFile&gt;
            &lt;/configuration&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;

      &lt;!-- Testing the result of the it pom.xml --&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.4.2&lt;/version&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;id&gt;it-test&lt;/id&gt;
            &lt;phase&gt;post-integration-test&lt;/phase&gt;
            &lt;goals&gt;
              &lt;goal&gt;test&lt;/goal&gt;
            &lt;/goals&gt;
            &lt;configuration&gt;
              &lt;includes&gt;
                &lt;include&gt;**/*TestIt.class&lt;/include&gt;
              &lt;/includes&gt;
            &lt;/configuration&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
  ...
&lt;/project&gt;</pre></div>
<p>The it pom should use the it snapshot:</p>
<div class="source"><pre class="prettyprint">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0
                      http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
...
  &lt;reporting&gt;
    &lt;outputDirectory&gt;
      ${project.basedir}/../../../../../target/it/it1/target/site
    &lt;/outputDirectory&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-XXX-plugin&lt;/artifactId&gt;
        &lt;version&gt;1.0-it-SNAPSHOT&lt;/version&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/reporting&gt;
...
&lt;/project&gt;</pre></div></div>
<div class="section">
<h3><a name="maven-plugin-management-plugin"></a>maven-plugin-management-plugin</h3>
<p>The <a class="externalLink" href="https://svn.apache.org/repos/asf/maven/sandbox/trunk/plugins/maven-plugin-management-plugin/">maven-plugin-management-plugin</a> is to stage/unstage a plugin into the local repository for pre/post-integration-test.</p>
<p>You need to configure the <tt>maven-plugin-test-plugin</tt> and the <tt>maven-surefire-plugin</tt>:</p>
<div class="source"><pre class="prettyprint">&lt;project
  xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0
                      http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
  ...
  &lt;artifactId&gt;maven-XXX-plugin&lt;/artifactId&gt;
  &lt;packaging&gt;maven-plugin&lt;/packaging&gt;
  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
  &lt;description&gt;Test Report plugin in the site phase&lt;/description&gt;
  &lt;prerequisites&gt;
    &lt;maven&gt;2.0.4&lt;/maven&gt;
  &lt;/prerequisites&gt;
  ...
  &lt;dependencies&gt;
    ...
    &lt;!-- Due to the Maven 2.0.4 prerequisites.
    By default, maven-plugin-test-plugin uses 2.0.1 --&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.maven&lt;/groupId&gt;
      &lt;artifactId&gt;maven-embedder&lt;/artifactId&gt;
      &lt;version&gt;2.0.4&lt;/version&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.maven&lt;/groupId&gt;
      &lt;artifactId&gt;maven-core&lt;/artifactId&gt;
      &lt;version&gt;2.0.4&lt;/version&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;
  &lt;build&gt;
    &lt;plugins&gt;
      ...
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-plugin-management-plugin&lt;/artifactId&gt;
        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;id&gt;pre-it-test&lt;/id&gt;
            &lt;phase&gt;pre-integration-test&lt;/phase&gt;
            &lt;goals&gt;
              &lt;goal&gt;stage&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
          &lt;execution&gt;
            &lt;id&gt;post-it-test&lt;/id&gt;
            &lt;phase&gt;post-integration-test&lt;/phase&gt;
            &lt;goals&gt;
              &lt;goal&gt;unstage&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;

      &lt;!-- Testing the result of the it pom.xml --&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.4.2&lt;/version&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;id&gt;it-test&lt;/id&gt;
            &lt;phase&gt;integration-test&lt;/phase&gt;
            &lt;goals&gt;
              &lt;goal&gt;test&lt;/goal&gt;
            &lt;/goals&gt;
            &lt;configuration&gt;
              &lt;includes&gt;
                &lt;include&gt;**/*TestIt.class&lt;/include&gt;
              &lt;/includes&gt;
            &lt;/configuration&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
  ...
&lt;/project&gt;</pre></div></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                    2002&#x2013;2015
                        <a href="http://www.apache.org/">The Apache Software Foundation</a>.
            All rights reserved.      
                    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
